#include <stdio.h>
#include <stdlib.h>
#include <time.h>

void DSA_sign(int message, int p, int q, int g, int x) {
    int k = rand() % q + 1;          // Random k each time
    int r = (g * k) % p % q;
    int s = (k + x * r + message) % q;

    printf("DSA Signature -> r = %d , s = %d (k = %d)\n", r, s, k);
}

int RSA_sign(int message, int d, int n) {
    int signature = 1;
    for (int i = 0; i < d; i++) {
        signature = (signature * message) % n;
    }
    return signature;
}

int main() {
    srand(time(NULL));

    int message = 25;

    int p = 23, q = 11, g = 2, x = 5;

    int d = 7, n = 33;

    printf("Signing SAME message twice...\n\n");

    printf("---- DSA ----\n");
    DSA_sign(message, p, q, g, x);
    DSA_sign(message, p, q, g, x);

    printf("\n---- RSA ----\n");
    int sig1 = RSA_sign(message, d, n);
    int sig2 = RSA_sign(message, d, n);

    printf("RSA Signature 1 = %d\n", sig1);
    printf("RSA Signature 2 = %d\n", sig2);

    return 0;
}
